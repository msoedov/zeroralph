# Ralph Progress Log
Started: 2026-01-29
---

## Codebase Patterns
- Use `/ralf` in .gitignore (not `ralf`) to avoid ignoring cmd/ralf/ directory
- Global ~/.gitignore ignores prd.json, CLAUDE.md, progress.txt - use `git add -f` to force add them
---

## 2026-01-29 - US-007
- What was implemented: Completion detection and iteration loop
- Files changed: prd.json (marked complete - implemented with US-006)
- **Learnings for future iterations:**
  - containsCompletion() checks for <promise>COMPLETE</promise> marker
  - Main loop prints "=== Iteration X/Y ===" for each iteration
  - Exit 0 on completion, exit 1 on max iterations
  - 2-second delay between iterations using time.Sleep
---

## 2026-01-29 - US-006
- What was implemented: AI tool execution with runTool() function
- Files changed: cmd/ralf/main.go, prd.json
- **Learnings for future iterations:**
  - runTool() reads prompt.md for amp, CLAUDE.md for claude
  - Uses exec.Command with stdin pipe for input
  - io.MultiWriter tees output to both stderr and buffer for capture
  - amp flags: --dangerously-allow-all
  - claude flags: --dangerously-skip-permissions --print
---

## 2026-01-29 - US-005
- What was implemented: Archive previous run when branch changes
- Files changed: prd.json (marked complete - implementation was already in place)
- **Learnings for future iterations:**
  - archivePreviousRun() compares .last-branch with prd.BranchName
  - Archive folder format: archive/YYYY-MM-DD-<branch-name>/
  - Strips "ralph/" prefix from branch name for folder name
  - Copies prd.json and progress.txt, then resets progress.txt
---

## 2026-01-29 - US-004
- What was implemented: Progress file initialization with header
- Files changed: prd.json (marked complete - implementation was already in place)
- **Learnings for future iterations:**
  - initProgressFile() creates file only if missing (uses os.Stat check)
  - Header format: "# Ralph Progress Log\nStarted: <timestamp>\n---\n"
  - Uses RFC1123 time format for timestamp
---

## 2026-01-29 - US-003
- What was implemented: PRD loading and validation with error handling
- Files changed: prd.json (marked complete - implementation was already in place)
- **Learnings for future iterations:**
  - loadPRD() loads from script directory (executable location, not cwd)
  - getScriptDir() uses os.Executable() to find binary location
  - Graceful error handling for missing file and invalid JSON
---

## 2026-01-29 - US-002
- What was implemented: CLI argument parsing with --tool, --help, --version, and positional max_iterations
- Files changed: prd.json (marked complete - implementation was already in place from US-001)
- **Learnings for future iterations:**
  - parseArgs() handles --tool flag with validation (amp|claude)
  - Positional numeric args are parsed as max_iterations
  - printUsage() provides comprehensive help text
---

## 2026-01-29 - US-001
- What was implemented: Go project structure with CLI entry point
- Files changed: go.mod, cmd/ralf/main.go, .gitignore, CLAUDE.md, prd.json, progress.txt
- **Learnings for future iterations:**
  - Project already had substantial implementation in main.go (arg parsing, PRD loading, progress file init, archiving)
  - Build with: `go build -o ralf ./cmd/ralf/`
  - Test with: `./ralf --version` and `./ralf --help`
---
